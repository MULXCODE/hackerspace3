<h2><%= @team.name %> Challenge Entries</h2>

<% @competition.checkpoints.order(:end_time).each do |checkpoint| %>

  <h3><%= checkpoint.name %> Checkpoint</h3>
  <% national_challenges = @team.national_challenges(checkpoint) %>
  <h4>National Challenges</h4>
  <%= "#{national_challenges.count} of #{pluralize checkpoint.max_national_challenges, 'national challenge'} entered" %><br>
  <% national_challenges.each do |challenge| %>
    <h5><%= challenge.name %></h5>
    Region: <%= challenge.region.name %><br>
    <%= link_to 'Leave Challenge', team_management_team_entry_path(@team, Entry.find_by(team: @team, challenge: challenge, checkpoint: checkpoint)),
    method: :delete, data: { confirm: 'Are you sure?' } %><br>
  <% end %>

  <% regional_challenges = @team.regional_challenges(checkpoint) %>
  <h4>Regional Challenges</h4>
  <%= "#{regional_challenges.count} of #{pluralize checkpoint.max_regional_challenges, 'regional challenge'} entered" %><br>
  <% regional_challenges.each do |challenge| %>
    <h5><%= challenge.name %></h5>
    Region: <%= challenge.region.name %><br>
    <%= link_to 'Leave Challenge', team_management_team_entry_path(@team, Entry.find_by(team: @team, challenge: challenge, checkpoint: checkpoint)),
    method: :delete, data: { confirm: 'Are you sure?' } %><br>
  <% end %>
<% end %>

<%= link_to 'Back to Team', team_management_team_path(@team) %>
