<main class="registration single-col manage-account">

	<h2>Manage Account</h2>

	<section>
		<article>

			<%= render 'user_contact', locals: { user: @user } %>

			<%= link_to 'Update Personal Details' , update_personal_details_path %><br>
			<%= link_to 'Change Email and Password' , edit_user_registration_path %><br>
			<% if current_user.admin_privileges? %>
				<%= link_to 'Region Management', admin_regions_path %><br>
				<%= link_to 'User Management', admin_users_path %><br>
				<%= link_to 'Competiton Management', admin_competition_path(Competition.current) %><br>
			<% end %>
			<% if current_user.sponsor_privileges? %>
				<%= link_to 'Sponsor Management', admin_sponsors_path %><br>
				<%= link_to 'Sponsorship Type Management', admin_sponsorship_types_path %><br>
			<% end %>
		</article>
	</section>

	<section>
		<article>
			<% if (assignments = current_user.assignments.where(title: SPONSOR_CONTACT)).present? %>
				<h3>My Sponsors</h3>
				<% assignments.each do |assignment| %>
					<h4><%= assignment.assignable.name %></h4>
					<%= link_to 'Go to Sponsor', admin_sponsor_path(assignment.assignable) %>
				<% end %>
			<% end %>
		</article>
		<article>

			<h3>My Events</h3>

			<% if (registrations = @user.event_assignment.registrations).present? %>

				<% registrations.each do |registration| %>
				<% event = registration.event %>
				<% region = event.region %>
				<h4><%= event.name %> -  <%= region.name %></h4>

				You are registered as: <%= registration.status %><br>

				<%= link_to 'Go to Event Page', event_path(event.identifier) %><br>
				<%= link_to 'Update Registration', edit_event_registration_path(event.identifier, registration) %><br>
			<% end %>

			<% else %>

				<div>You are not currently registered for any events.</div>
				<%= link_to 'Find events', events_path %>

			<% end %>
		</article>
		<article>
			<h3>My Team Projects</h3>

			<% if (teams = @user.teams).present? %>

				<% teams.each do |team| %>
					<% event = team.event %>
					<% team_name = team.current_project.team_name %>
					<%= "#{team_name} entered @ #{event.name}" %><br>
					<%= link_to "Go to #{team_name}", team_path(team) %><br>
				<% end %>

			<% else %>
				<div>You are not currenty apart of any team projects.</div>
				<%= link_to 'Find Competition Events', competition_events_path %><br>
			<% end %>
		</article>
	</section>
</main>
